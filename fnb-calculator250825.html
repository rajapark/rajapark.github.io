<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Planterra FNB ê³„ì‚°ê¸° â€“ v3.2 (Simple)</title>
<style>
:root{--pri:#1d4ed8;--pri2:#2563eb}
*{box-sizing:border-box}body{margin:0;background:#f8fafc;font-family:ui-sans-serif,system-ui,"Noto Sans KR"}
.wrap{max-width:1180px;margin:18px auto;padding:0 16px}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;overflow:hidden}
.hd{padding:12px 16px;background:linear-gradient(90deg,var(--pri2),var(--pri));color:#fff;font-weight:800}
.bd{padding:16px}
.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.grid4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px;align-items:center;margin:6px 0}
.lbl{font-size:12px;color:#374151;font-weight:700}
.inp{width:100%;padding:8px 10px;border:2px solid #e5e7eb;border-radius:8px}
.chipset{display:flex;gap:8px;flex-wrap:wrap}
.chip{position:relative;display:inline-block}
.chip input{position:absolute;opacity:0}
.chip label{display:inline-block;padding:7px 12px;border:1px solid #cbd5e1;border-radius:999px;font-size:12px;background:#fff;cursor:pointer}
.chip input:checked + label{background:#1d4ed8;color:#fff;border-color:#1d4ed8}

.tile{background:#f8fafc;border:1px solid #e2e8f0;border-radius:14px;padding:12px}
.tile h4{margin:0 0 4px;font-size:12px;color:#334155}
.bignum{font-size:18px;font-weight:900;line-height:1.15}

.box{border-radius:12px;padding:12px}
.g{background:#ECFDF5;border:1px solid #A7F3D0}
.o{background:#FFF7ED;border:1px solid #FED7AA}
.p{background:#F5F3FF;border:1px solid #DDD6FE}
.s{background:#F8FAFC;border:1px solid #E2E8F0}
.rowline{display:flex;justify-content:space-between;font-size:13px;margin-top:6px}
.total{display:flex;justify-content:space-between;border-top:1px solid #e5e7eb;margin-top:8px;padding-top:8px;font-weight:800}

.kpi{background:#0b1324;color:#fff;border-radius:14px;padding:14px}
.kpi .v{font-size:24px;font-weight:900;margin-top:4px}
.profit{background:#065f46!important}.loss{background:#7f1d1d!important}

.note{font-size:12px;line-height:1.6;color:#374151}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" style="padding:20px;text-align:center;margin-bottom:16px">
    <div style="font-size:22px;font-weight:900">Planterra FNB ê³„ì‚°ê¸° â€“ v3.2</div>
    <div style="font-size:12px;color:#475569">ì…ë ¥ ì—°ë™ Â· ë©´ì  êµ¬ë¶„ â†’ íˆ¬ìë¹„ â†’ ì›” ì†ìµ(BEP) â€” ER 1.2 mÂ²/ì¸ ê³ ì •</div>
  </div>

  <div class="grid3">
    <!-- 1. ì—…ì¢…/ë“±ê¸‰/ì…ë ¥ë°©ì‹ -->
    <div class="card">
      <div class="hd">ğŸ¯ ì—…ì¢… Â· ë“±ê¸‰ Â· ì…ë ¥ë°©ì‹</div>
      <div class="bd">
        <div class="lbl">ì—…ì¢…</div>
        <div class="chipset">
          <div class="chip"><input class="watch" type="radio" name="biz" id="b-er" value="employee_restaurant" checked><label for="b-er">êµ¬ë‚´/ë‹¨ì²´ê¸‰ì‹</label></div>
          <div class="chip"><input class="watch" type="radio" name="biz" id="b-rs" value="restaurant"><label for="b-rs">ë ˆìŠ¤í† ë‘</label></div>
          <div class="chip"><input class="watch" type="radio" name="biz" id="b-cf" value="cafe"><label for="b-cf">ì¹´í˜</label></div>
          <div class="chip"><input class="watch" type="radio" name="biz" id="b-fc" value="food_court"><label for="b-fc">í‘¸ë“œì½”íŠ¸</label></div>
        </div>

        <div class="lbl" style="margin-top:12px">í’ˆì§ˆ ë“±ê¸‰(í™€ ì¸í…Œë¦¬ì–´)</div>
        <div class="chipset">
          <div class="chip"><input class="watch" type="radio" name="grade" id="g-mid" value="mid"><label for="g-mid">ì¤‘</label></div>
          <div class="chip"><input class="watch" type="radio" name="grade" id="g-high" value="high" checked><label for="g-high">ìƒ</label></div>
          <div class="chip"><input class="watch" type="radio" name="grade" id="g-top" value="top"><label for="g-top">ìµœìƒ</label></div>
        </div>

        <div class="lbl" style="margin-top:12px">ì…ë ¥ ë°©ì‹</div>
        <div class="chipset">
          <div class="chip"><input class="watch" type="radio" name="mode" id="m-users" value="users" checked><label for="m-users">ëª©í‘œ ì´ìš©ê°ìˆ˜</label></div>
          <div class="chip"><input class="watch" type="radio" name="mode" id="m-seats" value="seats"><label for="m-seats">ì¢Œì„ìˆ˜</label></div>
          <div class="chip"><input class="watch" type="radio" name="mode" id="m-area" value="area"><label for="m-area">ì´ ë©´ì (í‰)</label></div>
        </div>
      </div>
    </div>

    <!-- 2. ìˆ˜ìš”/ë°€ë„ -->
    <div class="card">
      <div class="hd">ğŸ”· ìˆ˜ìš” Â· ë°€ë„</div>
      <div class="bd">
        <div class="row" id="rowUsers"><div class="lbl">ì¼ ì´ìš©ê°(ëª…)</div><input id="targetUsers" class="inp watch" type="number" value="500" min="10" max="300000"></div>
        <div class="row" id="rowSeats" style="display:none"><div class="lbl">ì¢Œì„ ìˆ˜(ì„)</div><input id="directSeats" class="inp watch" type="number" value="120" min="10" max="30000"></div>
        <div class="row" id="rowArea"  style="display:none"><div class="lbl">ì´ ë©´ì (í‰)</div><input id="areaPy" class="inp watch" type="number" value="60" min="10" max="5000"></div>

        <div class="row"><div class="lbl">ì¼ íšŒì „ìœ¨(íšŒ/ì¼)</div><input id="turnover" class="inp watch" type="number" value="2.5" step="0.1" min="0.3" max="12"></div>

        <!-- ER: 1.2 mÂ²/ì¸ ê³ ì • -->
        <div id="erBox" style="margin-top:8px">
          <div class="lbl">1ì¸ë‹¹ ì‹ë‹¹ ì´ë©´ì  (mÂ²/ì¸) â€” ê³ ì •</div>
          <input id="seatAreaER" class="inp" type="number" value="1.2" step="0.1" min="1.2" max="1.2" disabled>
        </div>

        <!-- ë ˆìŠ¤í† ë‘/ì¹´í˜/í‘¸ë“œì½”íŠ¸: ì¢Œì„ë°€ë„ -->
        <div id="restBox" style="display:none;margin-top:8px">
          <div class="lbl">í™€ ì¢Œì„ë°€ë„ (ì„/í‰)</div>
          <div class="chipset" style="margin-bottom:6px">
            <div class="chip"><input class="watch" type="radio" name="spp" id="spp10" value="1.0"><label for="spp10">1.0</label></div>
            <div class="chip"><input class="watch" type="radio" name="spp" id="spp11" value="1.1" checked><label for="spp11">1.1</label></div>
            <div class="chip"><input class="watch" type="radio" name="spp" id="spp12" value="1.2"><label for="spp12">1.2</label></div>
          </div>
          <input id="seatsPerPy" class="inp watch" type="number" value="1.1" step="0.1" min="0.5" max="4">
        </div>
      </div>
    </div>

    <!-- 3. ë©´ì  êµ¬ë¶„ -->
    <div class="card">
      <div class="hd">ğŸ“ ë©´ì  êµ¬ë¶„</div>
      <div class="bd grid4" id="areaSummary"></div>
    </div>
  </div>

  <!-- íˆ¬ìë¹„ -->
  <div class="card" style="margin-top:16px">
    <div class="hd">ğŸ’° íˆ¬ìë¹„ (ìë™ ê³„ì‚°)</div>
    <div class="bd" style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px">
      <div class="box g" id="hallOut"></div>
      <div class="box o" id="kitchenOut"></div>
      <div class="box p" id="mepOut"></div>
      <div class="box s" id="totalOut"></div>
    </div>
  </div>

  <!-- ì†ìµ -->
  <div class="card" style="margin-top:16px">
    <div class="hd">ğŸ“Š ì›” ì†ìµ ê³„ì‚° (ê°ê°€ í¬í•¨ Â· BEP)</div>
    <div class="bd">
      <div class="grid3">
        <div class="tile">
          <h4>ë§¤ì¶œ ì…ë ¥</h4>
          <div class="row"><div class="lbl">ì›” ë§¤ì¶œ(â‚©)</div><input id="revMonthly" class="inp watch" type="number" value="100000000" step="1000000"></div>
        </div>
        <div class="tile">
          <h4>ë³€ë™ë¹„(% of ë§¤ì¶œ)</h4>
          <div class="row"><div class="lbl">ì¬ë£Œë¹„(%)</div><input id="vFood" class="inp watch" type="number" value="33" step="0.5"></div>
          <div class="row"><div class="lbl">ë³€ë™ ì¸ê±´ë¹„(%)</div><input id="vLabor" class="inp watch" type="number" value="10" step="0.5"></div>
          <div class="row"><div class="lbl">ìœ í‹¸ë¦¬í‹°(%)</div><input id="vUtil" class="inp watch" type="number" value="5" step="0.1"></div>
          <div class="row"><div class="lbl">ê¸°íƒ€ ë³€ë™(%)</div><input id="vEtc" class="inp watch" type="number" value="2" step="0.1"></div>
        </div>
        <div class="tile">
          <h4>ê³ ì •ë¹„(â‚©/ì›”)</h4>
          <div class="row"><div class="lbl">ì„ëŒ€ë£Œ</div><input id="fRent" class="inp watch" type="number" value="8000000" step="500000"></div>
          <div class="row"><div class="lbl">ê³ ì • ì¸ê±´ë¹„</div><input id="fLabor" class="inp watch" type="number" value="15000000" step="500000"></div>
          <div class="row"><div class="lbl">ê¸°íƒ€ ê³ ì •</div><input id="fEtc" class="inp watch" type="number" value="3000000" step="500000"></div>
          <div class="row"><div class="lbl">ê°ê°€ê¸°ê°„(ë…„)</div><input id="paybackYears" class="inp watch" type="number" value="5" step="1" min="1" max="15"></div>
        </div>
      </div>

      <div class="grid3" style="margin-top:12px">
        <div class="kpi" id="kpiBEP"><div>ì†ìµë¶„ê¸° ë§¤ì¶œ(BEP)</div><div class="v"></div><div style="font-size:12px;opacity:.85" id="kpiBEPsub"></div></div>
        <div class="kpi" id="kpiProfit"><div>ì›” ì†ìµ(ê°ê°€ í¬í•¨)</div><div class="v"></div><div style="font-size:12px;opacity:.85" id="kpiProfitSub"></div></div>
        <div class="kpi" id="kpiCM"><div>ê¸°ì—¬ì´ìµë¥ </div><div class="v"></div><div style="font-size:12px;opacity:.85" id="kpiCMsub"></div></div>
      </div>
    </div>
  </div>

  <div class="card" style="margin:16px 0">
    <div class="hd">â„¹ï¸ ë¹„ê³ </div>
    <div class="bd note">
      â€¢ <b>êµ¬ì¡°ë³´ê°•, ì†Œë°©ì™„ë¹„, ëŒ€ìˆ˜ì„  ê³µì‚¬</b>ëŠ” <b>ë³„ë„</b>ì…ë‹ˆë‹¤.<br/>
      â€¢ 1ì°¨ ì…ìƒ(ì „ê¸°Â·ê¸‰ìˆ˜Â·ë°°ìˆ˜Â·ê°€ìŠ¤ ì¸ì…/ì¦ì„¤) ë˜í•œ <b>ë³„ë„</b>ì…ë‹ˆë‹¤.<br/>
      â€¢ ë³¸ ê³„ì‚°ê¸°ëŠ” <b>ì°¸ê³ ìš©</b> ì˜ˆì‹œì´ë©°, ì‹¤ì œ ì„¤ê³„Â·ì‹œê³µÂ·ì¸í—ˆê°€/ë²•ì  ì±…ì„ìë£Œê°€ ì•„ë‹™ë‹ˆë‹¤. ìµœì¢… ë©´ì Â·ë‹¨ê°€Â·ê²¬ì ì€
        í˜„ì¥ ì¡°ì‚¬ì™€ ì„¤ê³„ë„ë©´, ì‹œê³µì‚¬ ì‚°ì¶œë‚´ì—­ìœ¼ë¡œ í™•ì •ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.<br/>
      â€¢ ì¸í…Œë¦¬ì–´ ê³µì‚¬ë¹„ëŠ” <b>ë§ˆê°ì¬ ì‚¬ì–‘</b>ì— ë”°ë¼ í° í¸ì°¨ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
  </div>
</div>

<script>
(function(){
  const KRW = n => new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(Number(n)||0);
  const fmt = (n,d=1,u="") => `${Number(n||0).toLocaleString("ko-KR",{minimumFractionDigits:d,maximumFractionDigits:d})} ${u}`;
  const fmtInt = (n,u="") => `${Math.round(n||0).toLocaleString("ko-KR")} ${u}`;
  const $ = id => document.getElementById(id);
  const val = id => parseFloat(($(id)?.value)||"0");

  // 2025 ì‹¤í–‰ê°€ ê·¼ì ‘ í‰ë‹¨ê°€
  const COST = {
    hallUnit:{mid:2000000,high:3250000,top:5500000},
    hallVentPerPy:250000, hallHVACPerPy:400000, hallElectricalPerPy:150000, hallFacilityBasicPerPy:50000,
    furniturePerSeat:{mid:130000,high:180000,top:260000},
    kitchenInteriorPerPy:2500000, kitchenVentPerPy:600000, kitchenHVACPerPy:400000,
    kitchenPlumbGasPerPy:600000, kitchenElectricalPerPy:225000, kitchenEquipPerPy:3000000,
    kShare:{employee_restaurant:0.40, restaurant:0.30, cafe:0.30, food_court:0.50},
    erSeatArea:1.2, erMinSeats:100, erMinKitchenPy:5
  };
  const DEFAULT_SPP = {restaurant:1.1, cafe:1.3, food_court:1.3};

  function getRadio(name){
    const r = document.querySelector(`input[name="${name}"]:checked`);
    return r ? r.value : "";
  }

  function toggleUI(){
    const mode = getRadio("mode");
    $("rowUsers").style.display = (mode==="users") ? "" : "none";
    $("rowSeats").style.display = (mode==="seats") ? "" : "none";
    $("rowArea").style.display  = (mode==="area")  ? "" : "none";

    const biz = getRadio("biz");
    if(biz==="employee_restaurant"){
      $("erBox").style.display=""; $("restBox").style.display="none";
    }else{
      $("erBox").style.display="none"; $("restBox").style.display="";
      const def = DEFAULT_SPP[biz] || 1.1;
      $("seatsPerPy").value = def;
      document.getElementById("spp11").checked = (def===1.1);
      document.getElementById("spp10").checked = (def===1.0);
      document.getElementById("spp12").checked = (def===1.2);
    }
  }

  function recalc(){
    const biz   = getRadio("biz");
    const grade = getRadio("grade");
    const mode  = getRadio("mode");
    const kShare = COST.kShare[biz];

    const turnover = Math.max(0.3, val("turnover"));
    const spp = (biz==="employee_restaurant") ? null : (parseFloat($("seatsPerPy").value)||DEFAULT_SPP[biz]||1.1);

    let seats=0, hallPy=0, kitchenPy=0, totalPy=0;

    if(mode==="users"){
      seats = Math.max(10, Math.ceil(val("targetUsers")/turnover));
      if(biz==="employee_restaurant"){
        const totalM2 = seats * COST.erSeatArea; totalPy = totalM2/3.3058;
        kitchenPy = totalPy * kShare; hallPy = totalPy - kitchenPy;
        if(seats<=COST.erMinSeats && kitchenPy<COST.erMinKitchenPy){ kitchenPy=COST.erMinKitchenPy; hallPy=totalPy-kitchenPy; }
      }else{
        hallPy = Math.max(5, seats/Math.max(0.5,spp));
        kitchenPy = hallPy * (kShare/(1-kShare)); totalPy = hallPy + kitchenPy;
      }
    }else if(mode==="seats"){
      seats = Math.max(10, Math.round(val("directSeats")));
      if(biz==="employee_restaurant"){
        const totalM2 = seats * COST.erSeatArea; totalPy = totalM2/3.3058;
        kitchenPy = totalPy * kShare; hallPy = totalPy - kitchenPy;
        if(seats<=COST.erMinSeats && kitchenPy<COST.erMinKitchenPy){ kitchenPy=COST.erMinKitchenPy; hallPy=totalPy-kitchenPy; }
      }else{
        hallPy = Math.max(5, seats/Math.max(0.5,spp));
        kitchenPy = hallPy * (kShare/(1-kShare)); totalPy = hallPy + kitchenPy;
      }
    }else{ // area
      totalPy = Math.max(10, val("areaPy"));
      kitchenPy = totalPy * kShare; hallPy = totalPy - kitchenPy;
      if(biz==="employee_restaurant"){
        const seatsER = Math.floor((totalPy*3.3058)/COST.erSeatArea);
        seats = Math.max(10, seatsER);
        if(seats<=COST.erMinSeats && kitchenPy<COST.erMinKitchenPy){ kitchenPy=COST.erMinKitchenPy; hallPy=totalPy-kitchenPy; }
      }else{
        seats = Math.max(10, Math.floor(hallPy*Math.max(0.5,spp)));
      }
    }

    const totalM2 = totalPy*3.3058;
    const estUsers = seats * turnover;

    // ===== íˆ¬ìë¹„ =====
    const hallUnit = COST.hallUnit[grade];
    const furnUnit = COST.furniturePerSeat[grade];
    const sppForFurn = (biz==="employee_restaurant") ? ((hallPy>0)? (seats/Math.max(1,hallPy)) : 1.5) : spp;

    const hallInterior = hallPy*hallUnit;
    const hallFurniture= hallPy*Math.max(0.5,sppForFurn)*furnUnit;
    const hallVent     = hallPy*COST.hallVentPerPy;
    const hallHVAC     = hallPy*COST.hallHVACPerPy;
    const hallElec     = hallPy*COST.hallElectricalPerPy;
    const hallFac      = hallPy*COST.hallFacilityBasicPerPy;
    const hallSubtotal = hallInterior+hallFurniture+hallVent+hallHVAC+hallElec+hallFac;

    const kInterior    = kitchenPy*COST.kitchenInteriorPerPy;
    const kVent        = kitchenPy*COST.kitchenVentPerPy;
    const kHVAC        = kitchenPy*COST.kitchenHVACPerPy;
    const kPlumbGas    = kitchenPy*COST.kitchenPlumbGasPerPy;
    const kElec        = kitchenPy*COST.kitchenElectricalPerPy;
    const kEquip       = kitchenPy*COST.kitchenEquipPerPy;
    const kitchenSubtotal = kInterior+kVent+kHVAC+kPlumbGas+kElec+kEquip;

    const hardSubtotal = hallSubtotal+kitchenSubtotal;
    const designPct=4.0, supervisionPct=2.5, pmPct=5.0, contingencyPct=10.0;
    const design       = hardSubtotal*(designPct/100);
    const supervision  = hardSubtotal*(supervisionPct/100);
    const pm           = hardSubtotal*(pmPct/100);
    const subtotal     = hardSubtotal+design+supervision+pm;
    const contingency  = subtotal*(contingencyPct/100);
    const grandTotal   = subtotal+contingency;
    const perPy        = grandTotal/Math.max(1,totalPy);

    // ===== ë©´ì  êµ¬ë¶„ ì¶œë ¥ =====
    $("areaSummary").innerHTML = `
      <div class="tile"><h4>ì´ ë©´ì </h4><div class="bignum">${fmt(totalPy,1,"í‰ /")} ${fmt(totalM2,1,"mÂ²")}</div></div>
      <div class="tile"><h4>í™€ ë©´ì </h4><div class="bignum">${fmt(hallPy,1,"í‰")}</div></div>
      <div class="tile"><h4>í™€ ì¢Œì„ìˆ˜</h4><div class="bignum">${fmtInt(seats,"ì„")}</div></div>
      <div class="tile"><h4>ì£¼ë°© ë©´ì </h4><div class="bignum">${fmt(kitchenPy,1,"í‰")}</div></div>
      <div class="tile"><h4>ì˜ˆìƒ ì¼ ì´ìš©ê°</h4><div class="bignum">${fmtInt(estUsers,"ëª…/ì¼")}</div></div>
    `;

    const row=(n,v)=>`<div class="rowline"><span>${n}</span><span style="font-weight:700">${KRW(v)}</span></div>`;
    const total=(n,v,c)=>`<div class="total" style="color:${c}"><span>${n}</span><span>${KRW(v)}</span></div>`;

    $("hallOut").innerHTML = `
      <b>ğŸ¢ í™€</b>
      ${row("ì¸í…Œë¦¬ì–´",hallInterior)}
      ${row("ê°€êµ¬(ì˜íƒì)",hallFurniture)}
      ${row("ê¸‰ë°°ê¸°",hallVent)}
      ${row("ëƒ‰ë‚œë°©(4way)",hallHVAC)}
      ${row("ì „ê¸°Â·ì¡°ëª…Â·í†µì‹ ",hallElec)}
      ${row("ê¸°ë³¸ ì„¤ë¹„(2ì°¨)",hallFac)}
      ${total("í™€ ì†Œê³„",hallSubtotal,"#065F46")}
    `;
    $("kitchenOut").innerHTML = `
      <b>ğŸ‘¨â€ğŸ³ ì£¼ë°©</b>
      ${row("ê±´ì¶•(ë°©ìˆ˜ í¬í•¨)",kInterior)}
      ${row("ê¸‰ë°°ê¸°(SUS)",kVent)}
      ${row("ëƒ‰ë‚œë°©(4way)",kHVAC)}
      ${row("ì„¤ë¹„(ê¸‰ìˆ˜Â·ê¸‰íƒ•Â·ìœ„ìƒÂ·ê°€ìŠ¤)",kPlumbGas)}
      ${row("ì „ê¸°Â·ë™ë ¥Â·ì¥ë¹„ë°°ì„ ",kElec)}
      ${row("ì¥ë¹„",kEquip)}
      ${total("ì£¼ë°© ì†Œê³„",kitchenSubtotal,"#9A3412")}
    `;
    $("mepOut").innerHTML = `
      <b>ğŸ§¯ ê³µí†µ/ë³„ë„</b>
      <div class="rowline"><span>ì†Œë°© ê³µì‚¬</span><span style="font-weight:700">ë³„ë„</span></div>
      <div class="rowline"><span>1ì°¨ ì…ìƒ(ì „ê¸°Â·ê¸‰ìˆ˜Â·ë°°ìˆ˜Â·ê°€ìŠ¤)</span><span style="font-weight:700">ë³„ë„</span></div>
      ${total("ê³µì‚¬ë¹„ ì†Œê³„",hardSubtotal,"#3730A3")}
    `;
    $("totalOut").innerHTML = `
      <b>ğŸ“¦ ì´ íˆ¬ìë¹„</b>
      ${row("ì„¤ê³„ë¹„(êµ­ê°€ ê³µì‹œ)",design)}
      ${row("ê°ë¦¬ë¹„",supervision)}
      ${row("PM",pm)}
      ${row("ì˜ˆë¹„ë¹„",contingency)}
      <div class="total"><span>ì´íˆ¬ìë¹„(ALL-IN)</span><span style="color:#1D4ED8;font-weight:900">${KRW(grandTotal)}</span></div>
      <div class="rowline" style="margin-top:6px"><span>í‰ë‹¹ íˆ¬ìë¹„</span><span style="font-weight:800">${KRW(perPy)} / í‰</span></div>
    `;

    // ===== ì†ìµ =====
    const R = Math.max(0, val("revMonthly"));
    const varRate = (val("vFood")+val("vLabor")+val("vUtil")+val("vEtc"))/100;
    const varCost = R*varRate;
    const fixed   = Math.max(0,val("fRent"))+Math.max(0,val("fLabor"))+Math.max(0,val("fEtc"));
    const dep     = grandTotal/Math.max(1, val("paybackYears")*12);
    const cmRate  = 1 - varRate;
    const BEP     = cmRate>0 ? (fixed+dep)/cmRate : Infinity;
    const profit  = R - varCost - fixed - dep;

    const kpiProfit = $("kpiProfit"); kpiProfit.classList.remove("profit","loss"); kpiProfit.classList.add(profit>=0?"profit":"loss");
    $("kpiBEP").querySelector(".v").textContent = KRW(BEP);
    $("kpiBEPsub").textContent = `ê³ ì •ë¹„ ${KRW(fixed)} + ê°ê°€ ${KRW(dep)} / ê¸°ì—¬ì´ìµë¥  ${(cmRate*100).toFixed(1)}%`;
    $("kpiProfit").querySelector(".v").textContent = KRW(profit);
    $("kpiProfitSub").textContent = `ë§¤ì¶œ ${KRW(R)} â€“ ë³€ë™ë¹„ ${KRW(varCost)} â€“ ê³ ì •ë¹„ ${KRW(fixed)} â€“ ê°ê°€ ${KRW(dep)}`;
    $("kpiCM").querySelector(".v").textContent = `${(cmRate*100).toFixed(1)} %`;
    $("kpiCMsub").textContent = `ë³€ë™ë¹„ìœ¨ ${(varRate*100).toFixed(1)}%`;
  }

  function bindAll(){
    document.querySelectorAll(".watch").forEach(el=>{
      el.addEventListener("input", ()=>{ toggleUI(); recalc(); });
      el.addEventListener("change",()=>{ toggleUI(); recalc(); });
    });
  }
  function init(){ bindAll(); toggleUI(); recalc(); }
  document.addEventListener("DOMContentLoaded", init);
})();
</script>
</body>
</html>
